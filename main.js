!function(){"use strict";class e{constructor(e,t,s,r,n){this._name=e.name,this._link=e.link,this._cardSelector=t,this._handleCardClick=s,this.isLiked=e.isLiked,this._ownerId=e.owner._id,this._cardId=e._id,this._handleLikeClick=r,this._handleDeleteClick=n}_setEventListeners(){this._cardElement.querySelector(".card__button-like").addEventListener("click",(()=>{this._handleLikeClick()})),this._cardElement.querySelector(".card__button-delete").addEventListener("click",(()=>{this._handleDeleteClick(this._cardId)})),this._cardImage.addEventListener("click",(()=>{this._handleCardClick({name:this._name,link:this._link})}))}updateLikes(e){this.isLiked=e,this._toggleLikeButton()}_toggleLikeButton(){this.isLiked?this._likeButton.classList.add("card__button-like_active"):this._likeButton.classList.remove("card__button-like_active")}_handleDelete(){this._cardElement.remove()}_getTemplate(){return this._cardElement=document.querySelector(this._cardSelector).content.querySelector(".card").cloneNode(!0),this._cardElement}removeCardElement(){this._cardElement.remove()}getView(){return this._cardElement=this._getTemplate(),this._cardImage=this._cardElement.querySelector(".card__image"),this._cardTitle=this._cardElement.querySelector(".card__title"),this._likeButton=this._cardElement.querySelector(".card__button-like"),this._deleteButton=this._cardElement.querySelector(".card__button-delete"),this._cardImage.src=this._link,this._cardTitle.textContent=this._name,this._cardImage.alt=this._name,this._setEventListeners(),this._toggleLikeButton(),this._cardElement}}var t=class{constructor(e,t){this._inputSelector=e.inputSelector,this._submitButtonSelector=e.submitButtonSelector,this._inactiveButtonClass=e.inactiveButtonClass,this._inputErrorClass=e.inputErrorClass,this._errorClass=e.errorClass,this._formElement=t}_showInputError(e){const t=this._formElement.querySelector(`#${e.id}-error`);e.classList.add(this._inputErrorClass),t.textContent=e.validationMessage,t.classList.add(this._errorClass)}_hideInputError(e){const t=this._formElement.querySelector(`#${e.id}-error`);e.classList.remove(this._inputErrorClass),t.textContent="",t.classList.remove(this._errorClass)}_checkInputValidity(e){e.validity.valid?this._hideInputError(e):this._showInputError(e)}toggleButtonState(){this._hasInvalidInput()?(this._submitButton.classList.add(this._inactiveButtonClass),this._submitButton.disabled=!0):(this._submitButton.classList.remove(this._inactiveButtonClass),this._submitButton.disabled=!1)}_hasInvalidInput(){return this._inputEls.some((e=>!e.validity.valid))}_setEventListeners(){this._inputEls=[...this._formElement.querySelectorAll(this._inputSelector)],this._submitButton=this._formElement.querySelector(this._submitButtonSelector),this._inputEls.forEach((e=>{e.addEventListener("input",(()=>{this._checkInputValidity(e),this.toggleButtonState()}))})),this.toggleButtonState()}enableValidation(){this._formElement.addEventListener("submit",(e=>{e.preventDefault()})),this._setEventListeners()}};class s{constructor(e,t){let{items:s,renderer:r}=e;this._renderItems=s,this._renderer=r,this._container=t}renderItems(){console.log("this._renderItems:",this._renderItems),this._renderItems.forEach((e=>{this._renderer(e)}))}addItem(e){this._container.prepend(e)}}class r{constructor(e){let{popupSelector:t}=e;this._popupElement=document.querySelector(t)}open(){this._popupElement.classList.add("modal_opened"),document.addEventListener("keydown",this._handleEscClose)}close(){this._popupElement.classList.remove("modal_opened"),document.removeEventListener("keydown",this._handleEscClose)}_closeModalClick=e=>{(e.target.classList.contains("modal__close")||e.target.classList.contains("modal"))&&this.close()};_handleEscClose=e=>{"Escape"===e.key&&this.close()};setEventListeners(){this._popupElement.addEventListener("click",this._closeModalClick)}}class n extends r{constructor(e,t){super({popupSelector:e}),this._popupForm=document.querySelector(`${e} .modal__form`),this._handleFormSubmit=t,this._submitButton=this._popupForm.querySelector(".modal__button"),this._submitButtonText=this._submitButton.textContent}setLoading(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Saving...";this._submitButton.textContent=e?t:this._submitButtonText}_getInputValues(){const e={};return this._popupForm.querySelectorAll(".modal__form-input").forEach((t=>{""!==t.value&&(e[t.name]=t.value)})),e}_submitForm=e=>{e.preventDefault(),this.setLoading(!0);const t=this._getInputValues();this._handleFormSubmit(t,(()=>{this.setLoading(!1),setTimeout((()=>{this.close()}),2e3)})),console.log(t)};setEventListeners(){super.setEventListeners(),this._popupElement.addEventListener("submit",this._submitForm)}close(){this._popupForm.reset(),super.close()}}const i=document.querySelector(".profile__title"),o=document.querySelector(".profile__subtitle"),a=document.querySelector("#profile-button-edit"),l=document.querySelector("#profile-edit-modal"),d=document.querySelector("#profile-title-input"),c=document.querySelector("#profile-subtitle-input"),u=l.querySelector("#modal-form-edit"),h=document.querySelector(".cards__list"),_=document.querySelector("#profile-button-add"),m=(document.querySelector("#profile-add-modal"),document.querySelector("#modal-form-add")),p=document.querySelector(".profile__image-edit"),E=document.querySelector(".profile__image"),v=(document.querySelector("#modal-delete"),{formSelector:"modal__form",inputSelector:".modal__form-input",submitButtonSelector:".modal__button",inactiveButtonClass:"modal__button_disabled",inputErrorClass:"modal__form-input_type_error",errorClass:"modal__error_visible"}),b=new class{constructor(e){let{baseUrl:t,headers:s}=e;this._baseUrl=t,this._headers=s}_handleServerResponse(e){return e.json().then((t=>{if(e.ok)return console.log("Server response data:",t),t;throw console.error("Error data:",t),new Error(`Error: ${e.status}: ${t.message}`)}))}_request(e,t){return fetch(e,t).then(this._handleServerResponse)}getInitialCards(){return this._request(`${this._baseUrl}/cards`,{headers:this._headers})}getUserInfo(){return this._request(`${this._baseUrl}/users/me`,{headers:this._headers})}addCard(e){let{name:t,link:s}=e;return this._request(`${this._baseUrl}/cards`,{method:"POST",headers:this._headers,body:JSON.stringify({name:t,link:s})}).then(this._handleServerResponse)}removeCard(e){return this._request(`${this._baseUrl}/cards/${e}`,{method:"DELETE",headers:this._headers})}changeLikeStatus(e,t){return this._request(`${this._baseUrl}/cards/${e}/likes`,{method:t?"DELETE":"PUT",headers:this._headers})}updateUserInfo(e,t){return console.log(e,t),this._request(`${this._baseUrl}/users/me`,{method:"PATCH",headers:this._headers,body:JSON.stringify({name:e,about:t})})}setUserAvatar(e){return this._request(`${this._baseUrl}/users/me/avatar`,{method:"PATCH",headers:this._headers,body:JSON.stringify({avatar:e})})}}({baseUrl:"https://around-api.en.tripleten-services.com/v1",headers:{authorization:"1ccf1ba4-0220-4b67-950b-c472a98644ae","Content-Type":"application/json"}}),g=new t(v,m),S=new t(v,u);S.enableValidation(),g.enableValidation();const L=new n("#profile-edit-modal",(function(e){let{name:t,description:s}=e;L.setLoading(!0),b.updateUserInfo(t,s).then((()=>{w.setUserInfo(t,s),L.close()})).catch(console.error).finally((()=>{L.setLoading(!1)}))}));L.setEventListeners();const f=new n("#avatar-edit-modal",(function(e){let{url:t}=e;f.setLoading(!0),console.log(t),b.setUserAvatar(t).then((e=>{w.setUserAvatar(e.avatar),f.close()})).catch(console.error).finally((()=>{f.setLoading(!1)}))}));f.setEventListeners();const k=new class extends r{constructor(e){super({popupSelector:e}),this._popupForm=this._popupElement.querySelector(".modal__form"),this._submitButton=this._popupForm.querySelector(".modal__button"),this._submitButtonText=this._submitButton.textContent,this._form=this._popupElement.querySelector("form"),this._form.addEventListener("submit",(e=>{e.preventDefault(),this._handleFormSubmit()}))}setSubmitAction(e){this._handleFormSubmit=e}setLoading(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Removing...";this._submitButton.textContent=e?t:this._submitButtonText}close(){super.close(),this._popupForm.removeEventListener("submit",this._handleFormSubmit)}setEventListeners(){super.setEventListeners(),this._popupForm.addEventListener("submit",this._handleFormSubmit)}}("#modal-delete");function y(e){let{name:t,link:s}=e;B.open({name:t,link:s})}function C(t){const s=new e(t,"#card-template",y,(function(){b.changeLikeStatus(t._id,s.isLiked).then((e=>{console.log(e),s.updateLikes(e.isLiked)})).catch(console.error)}),(function(e){console.log(e),k.setSubmitAction((()=>{k.setLoading(!0),b.removeCard(e).then((e=>{s.removeCardElement(e._id),k.close()})).catch(console.error).finally((()=>{k.setLoading(!1)}))})),k.open()}));return s.getView()}let I,q;k.setEventListeners(),Promise.all([b.getInitialCards(),b.getUserInfo()]).then((e=>{let[t,r]=e;w.setUserInfo(r.name,r.about),w.setUserAvatar(r.avatar),q=r._id,I=new s({items:t,renderer:e=>{const t=C(e);I.addItem(t)}},h),I.renderItems()})).catch(console.error);const B=new class extends r{constructor(e){super({popupSelector:e})}open(e){this._previewImageElement=this._popupElement.querySelector(".modal__image"),this._previewImageCaption=this._popupElement.querySelector(".modal__image-caption"),this._previewImageElement.alt=e.name,this._previewImageCaption.textContent=e.name,this._previewImageElement.src=e.link,super.open()}}("#image-modal");B.setEventListeners();const w=new class{constructor(e,t,s){this._nameElement=e,this._jobElement=t,this._avatarElement=s}getUserInfo(){const e={};return e.name=this._nameElement.textContent,e.description=this._jobElement.textContent,console.log(e),e}setUserInfo(e,t){this._nameElement.textContent=e,this._jobElement.textContent=t}setUserAvatar(e){this._avatarElement.src=e,this._avatarElement.alt=this._nameElement.textcontent}}(i,o,E),U=new n("#profile-add-modal",(function(e){let{name:t,link:s}=e;U.setLoading(!0),b.addCard({name:t,link:s}).then((e=>{const t=C(e);I.addItem(t)})).catch(console.error).finally((()=>{U.setLoading(!1),U.close(),location.reload()}))}));U.setEventListeners(),a.addEventListener("click",(()=>{const{name:e,description:t}=w.getUserInfo();d.value=e,c.value=t,L.open(),S.toggleButtonState()})),_.addEventListener("click",(()=>{U.open(),g.toggleButtonState()})),p.addEventListener("click",(()=>{f.open()}))}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QWlCLFNBQVMsS0FDMUMsTUFBTSxLQUFFZixFQUFJLFlBQUVpSyxHQUFnQlUsRUFBU3JCLGNBRXZDN0IsRUFBa0JWLE1BQVEvRyxFQUMxQjBILEVBQXFCWCxNQUFRa0QsRUFFN0JRLEVBQVVsRixPQUNWaUYsRUFBa0IvRyxtQkFBbUIsSUFHdkNvRSxFQUFpQjlHLGlCQUFpQixTQUFTLEtBQ3pDeUwsRUFBYWpILE9BQ2IrRSxFQUFpQjdHLG1CQUFtQixJQUd0Q3NFLEVBQWlCaEgsaUJBQWlCLFNBQVMsS0FDekNnSyxFQUFnQnhGLE1BQU0sRyIsInNvdXJjZXMiOlsid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL0NhcmQuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9TZWN0aW9uLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL1BvcHVwLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aEZvcm0uanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL3V0aWxzL2NvbnN0YW50cy5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvcGFnZXMvaW5kZXguanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvQXBpLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aENvbmZpcm0uanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2UuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvVXNlckluZm8uanMiXSwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IGRlZmF1bHQgY2xhc3MgQ2FyZCB7XHJcbiAgICBjb25zdHJ1Y3RvcihcclxuICAgICAgICBjYXJkRGF0YSwgXHJcbiAgICAgICAgY2FyZFNlbGVjdG9yLCBcclxuICAgICAgICBoYW5kbGVDYXJkQ2xpY2ssXHJcbiAgICAgICAgaGFuZGxlTGlrZUNsaWNrLFxyXG4gICAgICAgIGhhbmRsZURlbGV0ZUNsaWNrKSB7XHJcbiAgICAgICAgdGhpcy5fbmFtZSA9IGNhcmREYXRhLm5hbWU7XHJcbiAgICAgICAgdGhpcy5fbGluayA9IGNhcmREYXRhLmxpbms7XHJcbiAgICAgICAgdGhpcy5fY2FyZFNlbGVjdG9yID0gY2FyZFNlbGVjdG9yO1xyXG4gICAgICAgIHRoaXMuX2hhbmRsZUNhcmRDbGljayA9IGhhbmRsZUNhcmRDbGljaztcclxuICAgICAgICB0aGlzLmlzTGlrZWQgPSBjYXJkRGF0YS5pc0xpa2VkO1xyXG4gICAgICAgIHRoaXMuX293bmVySWQgPSBjYXJkRGF0YS5vd25lci5faWQ7XHJcbiAgICAgICAgdGhpcy5fY2FyZElkID0gY2FyZERhdGEuX2lkO1xyXG4gICAgICAgIHRoaXMuX2hhbmRsZUxpa2VDbGljayA9IGhhbmRsZUxpa2VDbGljaztcclxuICAgICAgICB0aGlzLl9oYW5kbGVEZWxldGVDbGljayA9IGhhbmRsZURlbGV0ZUNsaWNrO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgX3NldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgICAgIHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoYC5jYXJkX19idXR0b24tbGlrZWApXHJcbiAgICAgICAgLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMuX2hhbmRsZUxpa2VDbGljaygpO1xyXG4gICAgICAgIH0pXHJcblxyXG4gICAgICAgIHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fYnV0dG9uLWRlbGV0ZVwiKVxyXG4gICAgICAgIC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLl9oYW5kbGVEZWxldGVDbGljayh0aGlzLl9jYXJkSWQpO1xyXG4gICAgICAgIH0pXHJcblxyXG4gICAgICAgIHRoaXMuX2NhcmRJbWFnZS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLl9oYW5kbGVDYXJkQ2xpY2soeyBuYW1lOiB0aGlzLl9uYW1lLCBsaW5rOiB0aGlzLl9saW5rIH0pO1xyXG4gICAgICAgIH0pXHJcblxyXG4gICAgfVxyXG5cclxuICAgIHVwZGF0ZUxpa2VzKGlzTGlrZWQpIHtcclxuICAgICAgICB0aGlzLmlzTGlrZWQgPSBpc0xpa2VkO1xyXG4gICAgICAgIHRoaXMuX3RvZ2dsZUxpa2VCdXR0b24oKTtcclxuICAgIH1cclxuXHJcbiAgICBfdG9nZ2xlTGlrZUJ1dHRvbigpIHtcclxuICAgICAgICBpZiAodGhpcy5pc0xpa2VkKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX2xpa2VCdXR0b24uY2xhc3NMaXN0LmFkZChcImNhcmRfX2J1dHRvbi1saWtlX2FjdGl2ZVwiKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLl9saWtlQnV0dG9uLmNsYXNzTGlzdC5yZW1vdmUoXCJjYXJkX19idXR0b24tbGlrZV9hY3RpdmVcIik7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIF9oYW5kbGVEZWxldGUoKSB7IFxyXG4gICAgICAgIHRoaXMuX2NhcmRFbGVtZW50LnJlbW92ZSgpO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICBfZ2V0VGVtcGxhdGUoKSB7XHJcbiAgICAgIHRoaXMuX2NhcmRFbGVtZW50ID0gZG9jdW1lbnRcclxuICAgICAucXVlcnlTZWxlY3Rvcih0aGlzLl9jYXJkU2VsZWN0b3IpXHJcbiAgICAgLmNvbnRlbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkXCIpXHJcbiAgICAgLmNsb25lTm9kZSh0cnVlKTtcclxuICAgICAgcmV0dXJuIHRoaXMuX2NhcmRFbGVtZW50O1xyXG4gICAgfVxyXG4gICAgcmVtb3ZlQ2FyZEVsZW1lbnQoKSB7XHJcbiAgICAgICAgLy8gQXNzdW1pbmcgdGhpcy5fY2FyZEVsZW1lbnQgaXMgdGhlIGNhcmQgRE9NIGVsZW1lbnRcclxuICAgICAgICB0aGlzLl9jYXJkRWxlbWVudC5yZW1vdmUoKTtcclxuICAgICAgfVxyXG4gICAgZ2V0VmlldygpIHtcclxuICAgICB0aGlzLl9jYXJkRWxlbWVudCA9IHRoaXMuX2dldFRlbXBsYXRlKCk7XHJcbiAgICAgdGhpcy5fY2FyZEltYWdlID0gdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19pbWFnZVwiKTtcclxuICAgICB0aGlzLl9jYXJkVGl0bGUgPSB0aGlzLl9jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX3RpdGxlXCIpO1xyXG4gICAgIHRoaXMuX2xpa2VCdXR0b24gPSB0aGlzLl9jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2J1dHRvbi1saWtlXCIpO1xyXG4gICAgIHRoaXMuX2RlbGV0ZUJ1dHRvbiA9IHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fYnV0dG9uLWRlbGV0ZVwiKTtcclxuICAgICB0aGlzLl9jYXJkSW1hZ2Uuc3JjID0gdGhpcy5fbGluaztcclxuICAgICB0aGlzLl9jYXJkVGl0bGUudGV4dENvbnRlbnQgPSB0aGlzLl9uYW1lO1xyXG4gICAgIHRoaXMuX2NhcmRJbWFnZS5hbHQgPSB0aGlzLl9uYW1lO1xyXG5cclxuICAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycygpO1xyXG4gICAgIHRoaXMuX3RvZ2dsZUxpa2VCdXR0b24oKTtcclxuXHJcbiAgICAgcmV0dXJuIHRoaXMuX2NhcmRFbGVtZW50O1xyXG4gICAgfVxyXG59IiwiZXhwb3J0IGNsYXNzIEZvcm1WYWxpZGF0b3Ige1xyXG4gIGNvbnN0cnVjdG9yKGNvbmZpZywgZm9ybUVsZW1lbnQpIHtcclxuICAgIHRoaXMuX2lucHV0U2VsZWN0b3IgPSBjb25maWcuaW5wdXRTZWxlY3RvcjtcclxuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvblNlbGVjdG9yID0gY29uZmlnLnN1Ym1pdEJ1dHRvblNlbGVjdG9yO1xyXG4gICAgdGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyA9IGNvbmZpZy5pbmFjdGl2ZUJ1dHRvbkNsYXNzO1xyXG4gICAgdGhpcy5faW5wdXRFcnJvckNsYXNzID0gY29uZmlnLmlucHV0RXJyb3JDbGFzcztcclxuICAgIHRoaXMuX2Vycm9yQ2xhc3MgPSBjb25maWcuZXJyb3JDbGFzcztcclxuXHJcbiAgICB0aGlzLl9mb3JtRWxlbWVudCA9IGZvcm1FbGVtZW50O1xyXG4gIH1cclxuXHJcbiAgX3Nob3dJbnB1dEVycm9yKGlucHV0RWwpIHtcclxuICAgIGNvbnN0IGVycm9yTWVzc2FnZUVsID0gdGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihcclxuICAgICAgYCMke2lucHV0RWwuaWR9LWVycm9yYFxyXG4gICAgKTtcclxuICAgIGlucHV0RWwuY2xhc3NMaXN0LmFkZCh0aGlzLl9pbnB1dEVycm9yQ2xhc3MpO1xyXG4gICAgZXJyb3JNZXNzYWdlRWwudGV4dENvbnRlbnQgPSBpbnB1dEVsLnZhbGlkYXRpb25NZXNzYWdlO1xyXG4gICAgZXJyb3JNZXNzYWdlRWwuY2xhc3NMaXN0LmFkZCh0aGlzLl9lcnJvckNsYXNzKTtcclxuICB9XHJcblxyXG4gIF9oaWRlSW5wdXRFcnJvcihpbnB1dEVsKSB7XHJcbiAgICBjb25zdCBlcnJvck1lc3NhZ2VFbCA9IHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXHJcbiAgICAgIGAjJHtpbnB1dEVsLmlkfS1lcnJvcmBcclxuICAgICk7XHJcbiAgICBpbnB1dEVsLmNsYXNzTGlzdC5yZW1vdmUodGhpcy5faW5wdXRFcnJvckNsYXNzKTtcclxuICAgIGVycm9yTWVzc2FnZUVsLnRleHRDb250ZW50ID0gXCJcIjtcclxuICAgIGVycm9yTWVzc2FnZUVsLmNsYXNzTGlzdC5yZW1vdmUodGhpcy5fZXJyb3JDbGFzcyk7XHJcbiAgfVxyXG5cclxuICBfY2hlY2tJbnB1dFZhbGlkaXR5KGlucHV0RWwpIHtcclxuICAgIGlmICghaW5wdXRFbC52YWxpZGl0eS52YWxpZCkge1xyXG4gICAgICB0aGlzLl9zaG93SW5wdXRFcnJvcihpbnB1dEVsKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHRoaXMuX2hpZGVJbnB1dEVycm9yKGlucHV0RWwpXHJcbiAgICB9XHJcbiAgICBcclxuICB9XHJcblxyXG4gIHRvZ2dsZUJ1dHRvblN0YXRlKCkge1xyXG4gICAgaWYgKHRoaXMuX2hhc0ludmFsaWRJbnB1dCgpKSB7XHJcbiAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5jbGFzc0xpc3QuYWRkKHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MpO1xyXG4gICAgICB0aGlzLl9zdWJtaXRCdXR0b24uZGlzYWJsZWQgPSB0cnVlO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy5fc3VibWl0QnV0dG9uLmNsYXNzTGlzdC5yZW1vdmUodGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyk7XHJcbiAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5kaXNhYmxlZCA9IGZhbHNlO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgX2hhc0ludmFsaWRJbnB1dCgpIHtcclxuICAgIHJldHVybiB0aGlzLl9pbnB1dEVscy5zb21lKChpbnB1dEVsKSA9PiB7XHJcbiAgICAgIHJldHVybiAhaW5wdXRFbC52YWxpZGl0eS52YWxpZDtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcblxyXG4gIF9zZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgIHRoaXMuX2lucHV0RWxzID0gW1xyXG4gICAgICAuLi50aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKHRoaXMuX2lucHV0U2VsZWN0b3IpLFxyXG4gICAgXTtcclxuICBcclxuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbiA9IHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXHJcbiAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvblNlbGVjdG9yXHJcbiAgICApO1xyXG5cclxuICAgIHRoaXMuX2lucHV0RWxzLmZvckVhY2goKGlucHV0RWxlbWVudCkgPT4ge1xyXG4gICAgICBpbnB1dEVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImlucHV0XCIsICgpID0+IHtcclxuICAgICAgICB0aGlzLl9jaGVja0lucHV0VmFsaWRpdHkoaW5wdXRFbGVtZW50KTtcclxuICAgICAgICB0aGlzLnRvZ2dsZUJ1dHRvblN0YXRlKCk7XHJcbiAgICAgIH0pO1xyXG4gICAgfSk7XHJcblxyXG4gICAgdGhpcy50b2dnbGVCdXR0b25TdGF0ZSgpO1xyXG4gICAgXHJcbiAgfVxyXG5cclxuICBlbmFibGVWYWxpZGF0aW9uKCkge1xyXG4gICAgdGhpcy5fZm9ybUVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZSkgPT4ge1xyXG4gICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICB9KTtcclxuXHJcbiAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycygpO1xyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGRlZmF1bHQgRm9ybVZhbGlkYXRvcjtcclxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgU2VjdGlvbiB7XHJcbiAgICBjb25zdHJ1Y3Rvcih7IGl0ZW1zLCByZW5kZXJlciB9LCBjb250YWluZXIpIHtcclxuICAgICAgICB0aGlzLl9yZW5kZXJJdGVtcyA9IGl0ZW1zO1xyXG4gICAgICAgIHRoaXMuX3JlbmRlcmVyID0gcmVuZGVyZXI7XHJcbiAgICAgICAgdGhpcy5fY29udGFpbmVyID0gY29udGFpbmVyO1xyXG4gICAgfVxyXG5cclxuICAgIHJlbmRlckl0ZW1zKCkge1xyXG4gICAgICAgIGNvbnNvbGUubG9nKCd0aGlzLl9yZW5kZXJJdGVtczonLCB0aGlzLl9yZW5kZXJJdGVtcyk7XHJcbiAgICAgICAgdGhpcy5fcmVuZGVySXRlbXMuZm9yRWFjaCgoaXRlbSkgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLl9yZW5kZXJlcihpdGVtKTtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICBhZGRJdGVtKGNhcmRFbGVtZW50KSB7XHJcbiAgICAgICAgdGhpcy5fY29udGFpbmVyLnByZXBlbmQoY2FyZEVsZW1lbnQpO1xyXG4gICAgfVxyXG5cclxufSIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwIHtcclxuICAgIGNvbnN0cnVjdG9yICh7IHBvcHVwU2VsZWN0b3IgfSkge1xyXG4gICAgICAgIHRoaXMuX3BvcHVwRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IocG9wdXBTZWxlY3Rvcik7XHJcbiAgICB9XHJcblxyXG4gICAgb3BlbigpIHtcclxuICAgICAgICB0aGlzLl9wb3B1cEVsZW1lbnQuY2xhc3NMaXN0LmFkZChcIm1vZGFsX29wZW5lZFwiKTtcclxuICAgICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCB0aGlzLl9oYW5kbGVFc2NDbG9zZSk7XHJcbiAgICB9XHJcblxyXG4gICAgY2xvc2UoKSB7XHJcbiAgICAgICAgdGhpcy5fcG9wdXBFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoXCJtb2RhbF9vcGVuZWRcIik7XHJcbiAgICAgICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgdGhpcy5faGFuZGxlRXNjQ2xvc2UpO1xyXG4gICAgfVxyXG5cclxuICAgIF9jbG9zZU1vZGFsQ2xpY2sgPSAoZSkgPT4ge1xyXG4gICAgICAgIGlmIChcclxuICAgICAgICAgICAgZS50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKFwibW9kYWxfX2Nsb3NlXCIpIHx8XHJcbiAgICAgICAgICAgIGUudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucyhcIm1vZGFsXCIpXHJcbiAgICAgICAgKSB7XHJcbiAgICAgICAgICAgIHRoaXMuY2xvc2UoKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgX2hhbmRsZUVzY0Nsb3NlID0gKGUpID0+IHtcclxuICAgICAgICBpZiAoZS5rZXkgPT09IFwiRXNjYXBlXCIpIHtcclxuICAgICAgICAgICAgdGhpcy5jbG9zZSgpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBzZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgICAgICB0aGlzLl9wb3B1cEVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIHRoaXMuX2Nsb3NlTW9kYWxDbGljayk7XHJcbiAgICB9XHJcbn0iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXAuanNcIjtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwV2l0aEZvcm0gZXh0ZW5kcyBQb3B1cCB7XHJcbiAgICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yLCBoYW5kbGVGb3JtU3VibWl0KSB7XHJcbiAgICAgICAgc3VwZXIoeyBwb3B1cFNlbGVjdG9yIH0pO1xyXG4gICAgICAgIHRoaXMuX3BvcHVwRm9ybSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYCR7cG9wdXBTZWxlY3Rvcn0gLm1vZGFsX19mb3JtYCk7XHJcbiAgICAgICAgdGhpcy5faGFuZGxlRm9ybVN1Ym1pdCA9IGhhbmRsZUZvcm1TdWJtaXQ7XHJcbiAgICAgICAgdGhpcy5fc3VibWl0QnV0dG9uID0gdGhpcy5fcG9wdXBGb3JtLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2J1dHRvblwiKTtcclxuICAgICAgICB0aGlzLl9zdWJtaXRCdXR0b25UZXh0ID0gdGhpcy5fc3VibWl0QnV0dG9uLnRleHRDb250ZW50O1xyXG4gICAgfVxyXG5cclxuICAgIHNldExvYWRpbmcoaXNMb2FkaW5nLCBsb2FkaW5nVGV4dCA9IFwiU2F2aW5nLi4uXCIpIHtcclxuICAgICAgICBpZiAoaXNMb2FkaW5nKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi50ZXh0Q29udGVudCA9IGxvYWRpbmdUZXh0O1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi50ZXh0Q29udGVudCA9IHRoaXMuX3N1Ym1pdEJ1dHRvblRleHQ7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIF9nZXRJbnB1dFZhbHVlcygpIHtcclxuICAgICAgICBjb25zdCB2YWx1ZXMgPSB7fTtcclxuICAgICAgICBjb25zdCBpbnB1dExpc3QgPSB0aGlzLl9wb3B1cEZvcm0ucXVlcnlTZWxlY3RvckFsbChcIi5tb2RhbF9fZm9ybS1pbnB1dFwiKTtcclxuICAgICAgICBpbnB1dExpc3QuZm9yRWFjaCgoaW5wdXQpID0+IHtcclxuICAgICAgICAgICAgaWYgKGlucHV0LnZhbHVlICE9PSBcIlwiKSB7XHJcbiAgICAgICAgICAgICAgICB2YWx1ZXNbaW5wdXQubmFtZV0gPSBpbnB1dC52YWx1ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHJldHVybiB2YWx1ZXM7XHJcbiAgICB9XHJcblxyXG4gICAgX3N1Ym1pdEZvcm0gPSAoZXZlbnQpID0+IHtcclxuICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpOyAvLyBQcmV2ZW50IHRoZSBmb3JtIGZyb20gc3VibWl0dGluZyBub3JtYWxseVxyXG4gICAgICAgIHRoaXMuc2V0TG9hZGluZyh0cnVlKTsgLy8gRGlzYWJsZSB0aGUgc3VibWl0IGJ1dHRvbiBhbmQgc2hvdyBsb2FkaW5nIHRleHRcclxuICAgICAgICBjb25zdCBpbnB1dFZhbHVlcyA9IHRoaXMuX2dldElucHV0VmFsdWVzKCk7XHJcbiAgICAgICAgdGhpcy5faGFuZGxlRm9ybVN1Ym1pdChpbnB1dFZhbHVlcywgKCkgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLnNldExvYWRpbmcoZmFsc2UpOyAvLyBSZS1lbmFibGUgdGhlIHN1Ym1pdCBidXR0b24gYWZ0ZXIgdGhlIGZvcm0gaXMgaGFuZGxlZFxyXG4gICAgICAgICAgICAvLyBZb3UgY2FuIGFkZCBhIHRpbWVvdXQgaGVyZSBpZiB5b3Ugd2FudCB0byBrZWVwIHRoZSBwb3B1cCBvcGVuIGZvciBhIHdoaWxlXHJcbiAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5jbG9zZSgpOyAvLyBDbG9zZSB0aGUgcG9wdXAgYWZ0ZXIgYSBkZWxheVxyXG4gICAgICAgICAgICB9LCAyMDAwKTsgLy8gQWRqdXN0IHRoZSBkZWxheSBhcyBuZWVkZWRcclxuICAgICAgICB9KTtcclxuICAgICAgICBjb25zb2xlLmxvZyhpbnB1dFZhbHVlcyk7XHJcbiAgICB9O1xyXG5cclxuICAgIHNldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgICAgIHN1cGVyLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcbiAgICAgICAgdGhpcy5fcG9wdXBFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgdGhpcy5fc3VibWl0Rm9ybSk7XHJcbiAgICB9XHJcblxyXG4gICAgY2xvc2UoKSB7XHJcbiAgICAgICAgdGhpcy5fcG9wdXBGb3JtLnJlc2V0KCk7XHJcbiAgICAgICAgc3VwZXIuY2xvc2UoKTtcclxuICAgIH1cclxufVxyXG4iLCIvLyBleHBvcnQgY29uc3QgaW5pdGlhbENhcmRzID0gW1xyXG4vLyAgICAgIHtcclxuLy8gICAgICAgIG5hbWU6IFwiQnJ5Y2UgQ2FueW9uXCIsXHJcbi8vICAgICAgICBsaW5rOiBcImh0dHBzOi8vaW1hZ2VzLnVuc3BsYXNoLmNvbS9waG90by0xNjgxMDU2OTQzNTg5LTRkYjY3MDkzZmQ2ZD9peGxpYj1yYi00LjAuMyZpeGlkPU1ud3hNakEzZkRCOE1IeHdhRzkwYnkxd1lXZGxmSHg4ZkdWdWZEQjhmSHg4JmF1dG89Zm9ybWF0JmZpdD1jcm9wJnc9MTUzMyZxPTgwXCIsXHJcbi8vICAgICAgfSxcclxuLy8gICAgICB7XHJcbi8vICAgICAgICBuYW1lOiBcIkJpZyBTdXJcIixcclxuLy8gICAgICAgIGxpbms6IFwiaHR0cHM6Ly9pbWFnZXMudW5zcGxhc2guY29tL3Bob3RvLTE2NTU4Mjc3MTg0ODAtNTNlZmQ3NjU3MWY3P2l4bGliPXJiLTQuMC4zJml4aWQ9TW53eE1qQTNmREI4TUh4d2FHOTBieTF3WVdkbGZIeDhmR1Z1ZkRCOGZIeDgmYXV0bz1mb3JtYXQmZml0PWNyb3Amdz0xNDcwJnE9ODBcIixcclxuLy8gICAgICB9LFxyXG4vLyAgICAgIHtcclxuLy8gICAgICAgIG5hbWU6IFwiRW1lcmFsZCBCYXkgU3RhdGUgUGFya1wiLFxyXG4vLyAgICAgICAgbGluazogXCJodHRwczovL2ltYWdlcy51bnNwbGFzaC5jb20vcGhvdG8tMTQ0NTI2MjEwMjM4Ny01ZmJiMzBhNWU1OWQ/aXhsaWI9cmItNC4wLjMmaXhpZD1Nbnd4TWpBM2ZEQjhNSHh3YUc5MGJ5MXdZV2RsZkh4OGZHVnVmREI4Zkh4OCZhdXRvPWZvcm1hdCZmaXQ9Y3JvcCZ3PTY4NyZxPTgwXCIsXHJcbi8vICAgICAgfSxcclxuLy8gICAgICB7XHJcbi8vICAgICAgICBuYW1lOiBcIlllbGxvd3N0b25lIE5hdGlvbmFsIFBhcmtcIixcclxuLy8gICAgICAgIGxpbms6IFwiaHR0cHM6Ly9pbWFnZXMudW5zcGxhc2guY29tL3Bob3RvLTE0ODI5MzgyODk2MDctZTk1NzNmYzI1ZWJiP2l4bGliPXJiLTQuMC4zJml4aWQ9TW53eE1qQTNmREI4TUh4d2FHOTBieTF3WVdkbGZIeDhmR1Z1ZkRCOGZIeDgmYXV0bz1mb3JtYXQmZml0PWNyb3Amdz02ODcmcT04MFwiLFxyXG4vLyAgICAgIH0sXHJcbi8vICAgICAge1xyXG4vLyAgICAgICAgbmFtZTogXCJNb3VudCBSYWluaWVyXCIsXHJcbi8vICAgICAgICBsaW5rOiBcImh0dHBzOi8vaW1hZ2VzLnVuc3BsYXNoLmNvbS9waG90by0xNTk1MjU5NzM0NzQ0LWExZDNkNjlkNjFmNT9peGxpYj1yYi00LjAuMyZpeGlkPU1ud3hNakEzZkRCOE1IeHdhRzkwYnkxd1lXZGxmSHg4ZkdWdWZEQjhmSHg4JmF1dG89Zm9ybWF0JmZpdD1jcm9wJnc9Njg3JnE9ODBcIixcclxuLy8gICAgICB9LFxyXG4vLyAgICAgIHtcclxuLy8gICAgICAgIG5hbWU6IFwiQW50ZWxvcGUgQ2FueW9uXCIsXHJcbi8vICAgICAgICBsaW5rOiBcImh0dHBzOi8vaW1hZ2VzLnVuc3BsYXNoLmNvbS9waG90by0xNDkyNzI0NzI0ODk0LTc0NjRjMjdkMGNlYj9peGxpYj1yYi00LjAuMyZpeGlkPU1ud3hNakEzZkRCOE1IeHdhRzkwYnkxd1lXZGxmSHg4ZkdWdWZEQjhmSHg4JmF1dG89Zm9ybWF0JmZpdD1jcm9wJnc9MTA3NCZxPTgwXCIsXHJcbi8vICAgICAgfVxyXG4vLyAgICAgICBdO1xyXG5cclxuZXhwb3J0IGNvbnN0IHByb2ZpbGVUaXRsZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fdGl0bGVcIik7XHJcbmV4cG9ydCBjb25zdCBwcm9maWxlU3VidGl0bGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX3N1YnRpdGxlXCIpO1xyXG5leHBvcnQgY29uc3QgcHJvZmlsZUVkaXRCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3Byb2ZpbGUtYnV0dG9uLWVkaXRcIik7XHJcbmV4cG9ydCBjb25zdCBwcm9maWxlRWRpdE1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwcm9maWxlLWVkaXQtbW9kYWxcIik7XHJcbmV4cG9ydCBjb25zdCBwcm9maWxlVGl0bGVJbnB1dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcHJvZmlsZS10aXRsZS1pbnB1dFwiKTtcclxuZXhwb3J0IGNvbnN0IHByb2ZpbGVTdWJ0aXRsZUlucHV0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwcm9maWxlLXN1YnRpdGxlLWlucHV0XCIpO1xyXG5leHBvcnQgY29uc3QgcHJvZmlsZUVkaXRGb3JtID0gcHJvZmlsZUVkaXRNb2RhbC5xdWVyeVNlbGVjdG9yKFwiI21vZGFsLWZvcm0tZWRpdFwiKTtcclxuZXhwb3J0IGNvbnN0IGNhcmRMaXN0RWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRzX19saXN0XCIpO1xyXG5leHBvcnQgY29uc3QgcHJvZmlsZUFkZEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcHJvZmlsZS1idXR0b24tYWRkXCIpO1xyXG5leHBvcnQgY29uc3QgcHJvZmlsZUFkZE1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwcm9maWxlLWFkZC1tb2RhbFwiKTtcclxuZXhwb3J0IGNvbnN0IGNhcmRBZGRGb3JtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNtb2RhbC1mb3JtLWFkZFwiKTtcclxuZXhwb3J0IGNvbnN0IGF2YXRhckVkaXRCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2ltYWdlLWVkaXRcIik7XHJcbmV4cG9ydCBjb25zdCBwcm9maWxlQXZhdGFyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19pbWFnZVwiKTtcclxuZXhwb3J0IGNvbnN0IGRlbGV0ZU1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNtb2RhbC1kZWxldGVcIik7XHJcblxyXG5leHBvcnQgY29uc3QgY29uZmlnID0ge1xyXG4gICAgZm9ybVNlbGVjdG9yOiBcIm1vZGFsX19mb3JtXCIsXHJcbiAgICBpbnB1dFNlbGVjdG9yOiBcIi5tb2RhbF9fZm9ybS1pbnB1dFwiLFxyXG4gICAgc3VibWl0QnV0dG9uU2VsZWN0b3I6IFwiLm1vZGFsX19idXR0b25cIixcclxuICAgIGluYWN0aXZlQnV0dG9uQ2xhc3M6IFwibW9kYWxfX2J1dHRvbl9kaXNhYmxlZFwiLFxyXG4gICAgaW5wdXRFcnJvckNsYXNzOiBcIm1vZGFsX19mb3JtLWlucHV0X3R5cGVfZXJyb3JcIixcclxuICAgIGVycm9yQ2xhc3M6IFwibW9kYWxfX2Vycm9yX3Zpc2libGVcIixcclxuICB9OyIsImltcG9ydCBDYXJkIGZyb20gXCIuLi9jb21wb25lbnRzL0NhcmQuanNcIjtcclxuaW1wb3J0IEZvcm1WYWxpZGF0b3IgZnJvbSBcIi4uL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qc1wiO1xyXG5pbXBvcnQgU2VjdGlvbiBmcm9tIFwiLi4vY29tcG9uZW50cy9TZWN0aW9uLmpzXCI7XHJcbmltcG9ydCBQb3B1cFdpdGhJbWFnZSBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhJbWFnZS5qc1wiO1xyXG5pbXBvcnQgUG9wdXBXaXRoRm9ybSBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtLmpzXCI7XHJcbmltcG9ydCBVc2VySW5mbyBmcm9tIFwiLi4vY29tcG9uZW50cy9Vc2VySW5mby5qc1wiO1xyXG5pbXBvcnQgQXBpIGZyb20gXCIuLi9jb21wb25lbnRzL0FwaS5qc1wiO1xyXG5pbXBvcnQgXCIuLi9wYWdlcy9pbmRleC5jc3NcIjtcclxuaW1wb3J0IFBvcHVwV2l0aENvbmZpcm0gZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoQ29uZmlybS5qc1wiO1xyXG5pbXBvcnQge1xyXG4gIHByb2ZpbGVUaXRsZSxcclxuICBwcm9maWxlU3VidGl0bGUsXHJcbiAgcHJvZmlsZUVkaXRCdXR0b24sXHJcbiAgcHJvZmlsZVRpdGxlSW5wdXQsXHJcbiAgcHJvZmlsZVN1YnRpdGxlSW5wdXQsXHJcbiAgcHJvZmlsZUVkaXRGb3JtLFxyXG4gIGNhcmRMaXN0RWwsXHJcbiAgcHJvZmlsZUFkZEJ1dHRvbixcclxuICBjYXJkQWRkRm9ybSxcclxuICBjb25maWcsXHJcbiAgYXZhdGFyRWRpdEJ1dHRvbixcclxuICBwcm9maWxlQXZhdGFyLFxyXG59IGZyb20gXCIuLi91dGlscy9jb25zdGFudHMuanNcIjtcclxuXHJcbmNvbnN0IGFwaSA9IG5ldyBBcGkoe1xyXG4gIGJhc2VVcmw6IFwiaHR0cHM6Ly9hcm91bmQtYXBpLmVuLnRyaXBsZXRlbi1zZXJ2aWNlcy5jb20vdjFcIixcclxuICBoZWFkZXJzOiB7XHJcbiAgICBhdXRob3JpemF0aW9uOiBcIjFjY2YxYmE0LTAyMjAtNGI2Ny05NTBiLWM0NzJhOTg2NDRhZVwiLFxyXG4gICAgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCIsXHJcbiAgfSxcclxufSk7XHJcblxyXG5jb25zdCBhZGRGb3JtVmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3IoY29uZmlnLCBjYXJkQWRkRm9ybSk7XHJcbmNvbnN0IGVkaXRGb3JtVmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3IoY29uZmlnLCBwcm9maWxlRWRpdEZvcm0pO1xyXG5cclxuZWRpdEZvcm1WYWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xyXG5hZGRGb3JtVmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTtcclxuXHJcbi8vZWRpdCBwb3B1cFxyXG5jb25zdCBlZGl0UG9wdXAgPSBuZXcgUG9wdXBXaXRoRm9ybShcclxuICBcIiNwcm9maWxlLWVkaXQtbW9kYWxcIixcclxuICBoYW5kbGVFZGl0UHJvZmlsZVN1Ym1pdFxyXG4pO1xyXG5cclxuZWRpdFBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcblxyXG4vL2F2YXRhciBlZGl0IHBvcHVwXHJcbmNvbnN0IGF2YXRhckVkaXRQb3B1cCA9IG5ldyBQb3B1cFdpdGhGb3JtKFxyXG4gIFwiI2F2YXRhci1lZGl0LW1vZGFsXCIsXHJcbiAgaGFuZGxlQXZhdGFyRm9ybVN1Ym1pdFxyXG4pO1xyXG5cclxuYXZhdGFyRWRpdFBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcblxyXG4vL2RlbGV0ZSBwb3B1cFxyXG5jb25zdCBkZWxldGVQb3B1cCA9IG5ldyBQb3B1cFdpdGhDb25maXJtKFwiI21vZGFsLWRlbGV0ZVwiKTtcclxuXHJcbmRlbGV0ZVBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcblxyXG4vL1BvcHVwIHdpdGggaW1hZ2VcclxuZnVuY3Rpb24gaGFuZGxlUHJldmlld0ltYWdlKHsgbmFtZSwgbGluayB9KSB7XHJcbiAgcG9wdXBJbWFnZS5vcGVuKHsgbmFtZSwgbGluayB9KTtcclxufVxyXG5cclxuLy9yZW5kZXIgY2FyZCBmdW5jdGlvblxyXG5mdW5jdGlvbiByZW5kZXJDYXJkKGNhcmREYXRhKSB7XHJcbiAgY29uc3QgY2FyZEVsZW1lbnQgPSBuZXcgQ2FyZChcclxuICAgIGNhcmREYXRhLFxyXG4gICAgXCIjY2FyZC10ZW1wbGF0ZVwiLFxyXG4gICAgaGFuZGxlUHJldmlld0ltYWdlLFxyXG4gICAgZnVuY3Rpb24gaGFuZGxlTGlrZSgpIHtcclxuICAgICAgYXBpXHJcbiAgICAgIC5jaGFuZ2VMaWtlU3RhdHVzKGNhcmREYXRhLl9pZCwgY2FyZEVsZW1lbnQuaXNMaWtlZClcclxuICAgICAgLnRoZW4oKHJlcykgPT4ge1xyXG4gICAgICAgIGNvbnNvbGUubG9nKHJlcyk7XHJcbiAgICAgICAgY2FyZEVsZW1lbnQudXBkYXRlTGlrZXMocmVzLmlzTGlrZWQpO1xyXG4gICAgICB9KVxyXG4gICAgICAuY2F0Y2goY29uc29sZS5lcnJvcik7XHJcbiAgICB9LFxyXG5cclxuICAgIGZ1bmN0aW9uIGhhbmRsZURlbGV0ZShjYXJkSWQpIHtcclxuICAgICAgY29uc29sZS5sb2coY2FyZElkKVxyXG4gICAgICBkZWxldGVQb3B1cC5zZXRTdWJtaXRBY3Rpb24oKCkgPT4ge1xyXG4gICAgICAgIGRlbGV0ZVBvcHVwLnNldExvYWRpbmcodHJ1ZSk7XHJcbiAgICAgICAgYXBpXHJcbiAgICAgICAgLnJlbW92ZUNhcmQoY2FyZElkKVxyXG4gICAgICAgIC50aGVuKChyZXMpID0+IHtcclxuICAgICAgICAgIGNhcmRFbGVtZW50LnJlbW92ZUNhcmRFbGVtZW50KHJlcy5faWQpO1xyXG4gICAgICAgICAgZGVsZXRlUG9wdXAuY2xvc2UoKTtcclxuICAgICAgICB9KVxyXG4gICAgICAgIC5jYXRjaChjb25zb2xlLmVycm9yKVxyXG4gICAgICAgIC5maW5hbGx5KCgpID0+IHtcclxuICAgICAgICAgIGRlbGV0ZVBvcHVwLnNldExvYWRpbmcoZmFsc2UpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICB9KTtcclxuICAgICAgZGVsZXRlUG9wdXAub3BlbigpO1xyXG4gICAgfSxcclxuICApO1xyXG4gIHJldHVybiBjYXJkRWxlbWVudC5nZXRWaWV3KCk7XHJcbn1cclxuXHJcbmxldCBjYXJkU2VjdGlvbjtcclxubGV0IHVzZXJJZDtcclxuXHJcblByb21pc2UuYWxsKFthcGkuZ2V0SW5pdGlhbENhcmRzKCksIGFwaS5nZXRVc2VySW5mbygpXSlcclxuICAudGhlbigoW2luaXRpYWxDYXJkcywgdXNlckRhdGFdKSA9PiB7XHJcbiAgICAgICAgdXNlckluZm8uc2V0VXNlckluZm8odXNlckRhdGEubmFtZSwgdXNlckRhdGEuYWJvdXQpO1xyXG4gICAgdXNlckluZm8uc2V0VXNlckF2YXRhcih1c2VyRGF0YS5hdmF0YXIpO1xyXG4gICAgdXNlcklkID0gdXNlckRhdGEuX2lkO1xyXG4gICAgY2FyZFNlY3Rpb24gPSBuZXcgU2VjdGlvbihcclxuICAgICAge1xyXG4gICAgICAgIGl0ZW1zOiBpbml0aWFsQ2FyZHMsXHJcbiAgICAgICAgcmVuZGVyZXI6IChjYXJkRGF0YSkgPT4ge1xyXG4gICAgICAgICAgY29uc3QgY2FyZEVsZW1lbnQgPSByZW5kZXJDYXJkKGNhcmREYXRhKTtcclxuICAgICAgICAgIGNhcmRTZWN0aW9uLmFkZEl0ZW0oY2FyZEVsZW1lbnQpO1xyXG4gICAgICAgIH0sXHJcbiAgICAgIH0sXHJcbiAgICAgIGNhcmRMaXN0RWxcclxuICAgICk7XHJcbiAgICBjYXJkU2VjdGlvbi5yZW5kZXJJdGVtcygpO1xyXG4gIH0pXHJcbiAgLmNhdGNoKGNvbnNvbGUuZXJyb3IpO1xyXG5cclxuY29uc3QgcG9wdXBJbWFnZSA9IG5ldyBQb3B1cFdpdGhJbWFnZShcIiNpbWFnZS1tb2RhbFwiKTtcclxucG9wdXBJbWFnZS5zZXRFdmVudExpc3RlbmVycygpO1xyXG5cclxuLy91c2VyIGluZm9cclxuY29uc3QgdXNlckluZm8gPSBuZXcgVXNlckluZm8oXHJcbiAgcHJvZmlsZVRpdGxlLFxyXG4gIHByb2ZpbGVTdWJ0aXRsZSxcclxuICBwcm9maWxlQXZhdGFyXHJcbik7XHJcblxyXG4vL2hhbmRsZXJzXHJcbmZ1bmN0aW9uIGhhbmRsZUVkaXRQcm9maWxlU3VibWl0KHsgbmFtZSwgZGVzY3JpcHRpb24gfSkge1xyXG4gIGVkaXRQb3B1cC5zZXRMb2FkaW5nKHRydWUpO1xyXG4gIGFwaVxyXG4gICAgLnVwZGF0ZVVzZXJJbmZvKG5hbWUsIGRlc2NyaXB0aW9uKVxyXG4gICAgLnRoZW4oKCkgPT4ge1xyXG4gICAgICB1c2VySW5mby5zZXRVc2VySW5mbyhuYW1lLCBkZXNjcmlwdGlvbik7XHJcbiAgICAgIGVkaXRQb3B1cC5jbG9zZSgpO1xyXG4gICAgfSkgXHJcbiAgICAuY2F0Y2goY29uc29sZS5lcnJvcilcclxuICAgIC5maW5hbGx5KCgpID0+IHtcclxuICAgICAgZWRpdFBvcHVwLnNldExvYWRpbmcoZmFsc2UpO1xyXG4gICAgfSk7XHJcbn1cclxuXHJcbi8vbmV3IENhcmQgUG9wdXBcclxuY29uc3QgbmV3Q2FyZFBvcHVwID0gbmV3IFBvcHVwV2l0aEZvcm0oXHJcbiAgXCIjcHJvZmlsZS1hZGQtbW9kYWxcIixcclxuICBoYW5kbGVBZGRDYXJkRm9ybVN1Ym1pdFxyXG4pO1xyXG5cclxubmV3Q2FyZFBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcblxyXG5mdW5jdGlvbiBoYW5kbGVBZGRDYXJkRm9ybVN1Ym1pdCh7IG5hbWUsIGxpbmsgfSkge1xyXG4gIG5ld0NhcmRQb3B1cC5zZXRMb2FkaW5nKHRydWUpO1xyXG4gIGFwaVxyXG4gICAgLmFkZENhcmQoeyBuYW1lLCBsaW5rIH0pXHJcbiAgICAudGhlbigoY2FyZERhdGEpID0+IHtcclxuICAgICAgY29uc3QgY2FyZEVsZW1lbnQgPSByZW5kZXJDYXJkKGNhcmREYXRhKTtcclxuICAgICAgY2FyZFNlY3Rpb24uYWRkSXRlbShjYXJkRWxlbWVudCk7XHJcbiAgICB9KVxyXG4gICAgLmNhdGNoKGNvbnNvbGUuZXJyb3IpXHJcbiAgICAuZmluYWxseSgoKSA9PiB7XHJcbiAgICAgIG5ld0NhcmRQb3B1cC5zZXRMb2FkaW5nKGZhbHNlKTtcclxuICAgICAgbmV3Q2FyZFBvcHVwLmNsb3NlKCk7XHJcbiAgICAgIGxvY2F0aW9uLnJlbG9hZCgpO1xyXG4gICAgfSk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGhhbmRsZUF2YXRhckZvcm1TdWJtaXQoeyB1cmwgfSkge1xyXG4gIGF2YXRhckVkaXRQb3B1cC5zZXRMb2FkaW5nKHRydWUpO1xyXG4gIGNvbnNvbGUubG9nKHVybCk7XHJcbiAgYXBpXHJcbiAgLnNldFVzZXJBdmF0YXIodXJsKVxyXG4gIC50aGVuKCh1c2VyRGF0YSkgPT4ge1xyXG4gICAgdXNlckluZm8uc2V0VXNlckF2YXRhcih1c2VyRGF0YS5hdmF0YXIpO1xyXG4gICAgYXZhdGFyRWRpdFBvcHVwLmNsb3NlKCk7XHJcbiAgfSlcclxuICAuY2F0Y2goY29uc29sZS5lcnJvcilcclxuICAuZmluYWxseSgoKSA9PiB7XHJcbiAgICBhdmF0YXJFZGl0UG9wdXAuc2V0TG9hZGluZyhmYWxzZSk7XHJcbiAgfSk7XHJcbn1cclxuXHJcbi8vRXZlbnQgaGFuZGxlcnNcclxucHJvZmlsZUVkaXRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICBjb25zdCB7IG5hbWUsIGRlc2NyaXB0aW9uIH0gPSB1c2VySW5mby5nZXRVc2VySW5mbygpO1xyXG4gIFxyXG4gIHByb2ZpbGVUaXRsZUlucHV0LnZhbHVlID0gbmFtZTtcclxuICBwcm9maWxlU3VidGl0bGVJbnB1dC52YWx1ZSA9IGRlc2NyaXB0aW9uO1xyXG5cclxuICBlZGl0UG9wdXAub3BlbigpO1xyXG4gIGVkaXRGb3JtVmFsaWRhdG9yLnRvZ2dsZUJ1dHRvblN0YXRlKCk7XHJcbn0pO1xyXG5cclxucHJvZmlsZUFkZEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gIG5ld0NhcmRQb3B1cC5vcGVuKCk7XHJcbiAgYWRkRm9ybVZhbGlkYXRvci50b2dnbGVCdXR0b25TdGF0ZSgpO1xyXG59KTtcclxuXHJcbmF2YXRhckVkaXRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICBhdmF0YXJFZGl0UG9wdXAub3BlbigpO1xyXG5cclxufSk7XHJcblxyXG5cclxuXHJcbi8vY2FyZCBzZWN0aW9uXHJcblxyXG4vLyBjYXJkU2VjdGlvbi5yZW5kZXJJdGVtcygpO1xyXG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBBcGkge1xyXG4gICAgY29uc3RydWN0b3IoeyBiYXNlVXJsLCBoZWFkZXJzIH0pIHtcclxuICAgICAgdGhpcy5fYmFzZVVybCA9IGJhc2VVcmw7XHJcbiAgICAgIHRoaXMuX2hlYWRlcnMgPSBoZWFkZXJzO1xyXG4gICAgfVxyXG5cclxuICAgIF9oYW5kbGVTZXJ2ZXJSZXNwb25zZShyZXMpIHtcclxuICAgICAgcmV0dXJuIHJlcy5qc29uKCkudGhlbihkYXRhID0+IHtcclxuICAgICAgICBpZiAocmVzLm9rKSB7XHJcbiAgICAgICAgICBjb25zb2xlLmxvZygnU2VydmVyIHJlc3BvbnNlIGRhdGE6JywgZGF0YSk7XHJcbiAgICAgICAgICByZXR1cm4gZGF0YTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgLy8gTG9nIHRoZSBlcnJvciByZXNwb25zZSBmcm9tIHRoZSBzZXJ2ZXJcclxuICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGRhdGE6JywgZGF0YSk7XHJcbiAgICAgICAgICAvLyBUaHJvdyBhbiBlcnJvciB3aXRoIGJvdGggdGhlIHN0YXR1cyBhbmQgdGhlIGVycm9yIG1lc3NhZ2VcclxuICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgRXJyb3I6ICR7cmVzLnN0YXR1c306ICR7ZGF0YS5tZXNzYWdlfWApO1xyXG4gICAgICAgIH1cclxuICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgX3JlcXVlc3QodXJsLCBvcHRpb25zKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBmZXRjaCh1cmwsIG9wdGlvbnMpLnRoZW4odGhpcy5faGFuZGxlU2VydmVyUmVzcG9uc2UpO1xyXG4gICAgfVxyXG5cclxuICAgIGdldEluaXRpYWxDYXJkcygpIHtcclxuICAgICAgcmV0dXJuIHRoaXMuX3JlcXVlc3QoYCR7dGhpcy5fYmFzZVVybH0vY2FyZHNgLCB7IGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMgfSk7XHJcblxyXG4gICAgfVxyXG5cclxuICAgIGdldFVzZXJJbmZvKCkge1xyXG4gICAgICByZXR1cm4gdGhpcy5fcmVxdWVzdChgJHt0aGlzLl9iYXNlVXJsfS91c2Vycy9tZWAsIHtcclxuICAgICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgICB9KTtcclxuICAgIH1cclxuICAgIGFkZENhcmQoeyBuYW1lLCBsaW5rIH0pIHtcclxuICAgICAgcmV0dXJuIHRoaXMuX3JlcXVlc3QoYCR7dGhpcy5fYmFzZVVybH0vY2FyZHNgLCB7XHJcbiAgICAgICAgbWV0aG9kOiBcIlBPU1RcIixcclxuICAgICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHsgbmFtZSwgbGlua30pLFxyXG4gICAgfSlcclxuICAgIC50aGVuKHRoaXMuX2hhbmRsZVNlcnZlclJlc3BvbnNlKTtcclxuICAgIH1cclxuXHJcbiAgICByZW1vdmVDYXJkKGNhcmRJZCkge1xyXG4gICAgICByZXR1cm4gdGhpcy5fcmVxdWVzdChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkcy8ke2NhcmRJZH1gLCB7XHJcbiAgICAgICAgbWV0aG9kOiBcIkRFTEVURVwiLFxyXG4gICAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICBjaGFuZ2VMaWtlU3RhdHVzKGNhcmRJZCwgaXNMaWtlZCkge1xyXG4gICAgICByZXR1cm4gdGhpcy5fcmVxdWVzdChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkcy8ke2NhcmRJZH0vbGlrZXNgLCB7XHJcbiAgICAgICAgbWV0aG9kOiBpc0xpa2VkID8gXCJERUxFVEVcIiA6IFwiUFVUXCIsXHJcbiAgICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICB1cGRhdGVVc2VySW5mbyhuYW1lLCBkZXNjcmlwdGlvbikge1xyXG4gICAgY29uc29sZS5sb2cobmFtZSwgZGVzY3JpcHRpb24pO1xyXG4gICAgcmV0dXJuIHRoaXMuX3JlcXVlc3QoYCR7dGhpcy5fYmFzZVVybH0vdXNlcnMvbWVgLCB7XHJcbiAgICAgIG1ldGhvZDogXCJQQVRDSFwiLFxyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XHJcbiAgICAgICAgbmFtZTogbmFtZSxcclxuICAgICAgICBhYm91dDogZGVzY3JpcHRpb24sXHJcbiAgICAgIH0pLFxyXG4gICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgc2V0VXNlckF2YXRhcih1cmwpIHtcclxuICAgICAgcmV0dXJuIHRoaXMuX3JlcXVlc3QoYCR7dGhpcy5fYmFzZVVybH0vdXNlcnMvbWUvYXZhdGFyYCwge1xyXG4gICAgICAgIG1ldGhvZDogXCJQQVRDSFwiLFxyXG4gICAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xyXG4gICAgICAgIGF2YXRhcjogdXJsLFxyXG4gICAgICAgIH0pLFxyXG4gICAgICB9KTtcclxuICAgIH1cclxuICB9IiwiaW1wb3J0IFBvcHVwIGZyb20gXCIuL1BvcHVwLmpzXCI7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cFdpdGhDb25maXJtIGV4dGVuZHMgUG9wdXAge1xyXG4gICAgY29uc3RydWN0b3IocG9wdXBTZWxlY3Rvcikge1xyXG4gICAgICAgIHN1cGVyKHsgcG9wdXBTZWxlY3RvciB9KTtcclxuICAgICAgICB0aGlzLl9wb3B1cEZvcm0gPSB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fZm9ybVwiKTtcclxuICAgICAgICB0aGlzLl9zdWJtaXRCdXR0b24gPSB0aGlzLl9wb3B1cEZvcm0ucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fYnV0dG9uXCIpO1xyXG4gICAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvblRleHQgPSB0aGlzLl9zdWJtaXRCdXR0b24udGV4dENvbnRlbnQ7XHJcbiAgICAgICAgdGhpcy5fZm9ybSA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKCdmb3JtJyk7XHJcbiAgICAgICAgdGhpcy5fZm9ybS5hZGRFdmVudExpc3RlbmVyKCdzdWJtaXQnLCAoZSkgPT4ge1xyXG4gICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgICAgIHRoaXMuX2hhbmRsZUZvcm1TdWJtaXQoKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgIHNldFN1Ym1pdEFjdGlvbihhY3Rpb24pIHtcclxuICAgICAgICB0aGlzLl9oYW5kbGVGb3JtU3VibWl0ID0gYWN0aW9uO1xyXG4gICAgfVxyXG5cclxuICAgIHNldExvYWRpbmcoaXNMb2FkaW5nLCBsb2FkaW5nVGV4dCA9IFwiUmVtb3ZpbmcuLi5cIikge1xyXG4gICAgICAgIGlmKGlzTG9hZGluZykge1xyXG4gICAgICAgICAgICB0aGlzLl9zdWJtaXRCdXR0b24udGV4dENvbnRlbnQgPSBsb2FkaW5nVGV4dDtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLl9zdWJtaXRCdXR0b24udGV4dENvbnRlbnQgPSB0aGlzLl9zdWJtaXRCdXR0b25UZXh0O1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBjbG9zZSgpIHtcclxuICAgICAgICBzdXBlci5jbG9zZSgpO1xyXG4gICAgICAgIHRoaXMuX3BvcHVwRm9ybS5yZW1vdmVFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIHRoaXMuX2hhbmRsZUZvcm1TdWJtaXQpO1xyXG4gICAgfVxyXG5cclxuICAgIHNldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgICAgIHN1cGVyLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcbiAgICAgICAgdGhpcy5fcG9wdXBGb3JtLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgdGhpcy5faGFuZGxlRm9ybVN1Ym1pdCk7XHJcbiAgICB9XHJcbn0iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXAuanNcIjtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwV2l0aEltYWdlIGV4dGVuZHMgUG9wdXAge1xyXG4gICAgY29uc3RydWN0b3IocG9wdXBTZWxlY3Rvcikge1xyXG4gICAgICAgIHN1cGVyKHsgcG9wdXBTZWxlY3RvciB9KTtcclxuICAgIH1cclxuXHJcbiAgICBvcGVuKGRhdGEpIHtcclxuICAgICAgICB0aGlzLl9wcmV2aWV3SW1hZ2VFbGVtZW50ID0gXHJcbiAgICAgICAgdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2ltYWdlXCIpO1xyXG4gICAgICAgIHRoaXMuX3ByZXZpZXdJbWFnZUNhcHRpb24gPSBcclxuICAgICAgICB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9faW1hZ2UtY2FwdGlvblwiKTtcclxuICAgICAgICB0aGlzLl9wcmV2aWV3SW1hZ2VFbGVtZW50LmFsdCA9IGRhdGEubmFtZTtcclxuICAgICAgICB0aGlzLl9wcmV2aWV3SW1hZ2VDYXB0aW9uLnRleHRDb250ZW50ID0gZGF0YS5uYW1lO1xyXG4gICAgICAgIHRoaXMuX3ByZXZpZXdJbWFnZUVsZW1lbnQuc3JjID0gZGF0YS5saW5rO1xyXG5cclxuICAgICAgICBzdXBlci5vcGVuKCk7XHJcbiAgICB9XHJcbn0iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBVc2VySW5mbyB7XHJcbiAgY29uc3RydWN0b3IodXNlck5hbWVFbGVtZW50LCB1c2VySm9iRWxlbWVudCwgYXZhdGFyRWxlbWVudCkge1xyXG4gICAgdGhpcy5fbmFtZUVsZW1lbnQgPSAgdXNlck5hbWVFbGVtZW50O1xyXG4gICAgdGhpcy5fam9iRWxlbWVudCA9IHVzZXJKb2JFbGVtZW50O1xyXG4gICAgdGhpcy5fYXZhdGFyRWxlbWVudCA9IGF2YXRhckVsZW1lbnQ7XHJcbiAgfVxyXG5cclxuICBnZXRVc2VySW5mbygpIHtcclxuICAgIGNvbnN0IHByb2ZpbGVPYmplY3QgPSB7fTtcclxuICAgIHByb2ZpbGVPYmplY3RbXCJuYW1lXCJdID0gdGhpcy5fbmFtZUVsZW1lbnQudGV4dENvbnRlbnQ7XHJcbiAgICBwcm9maWxlT2JqZWN0W1wiZGVzY3JpcHRpb25cIl0gPSB0aGlzLl9qb2JFbGVtZW50LnRleHRDb250ZW50O1xyXG4gICAgY29uc29sZS5sb2cocHJvZmlsZU9iamVjdCk7XHJcbiAgICByZXR1cm4gcHJvZmlsZU9iamVjdDtcclxuICB9XHJcblxyXG4gIHNldFVzZXJJbmZvKG5hbWUsIGRlc2NyaXB0aW9uKSB7XHJcbiAgICB0aGlzLl9uYW1lRWxlbWVudC50ZXh0Q29udGVudCA9IG5hbWU7XHJcbiAgICB0aGlzLl9qb2JFbGVtZW50LnRleHRDb250ZW50ID0gZGVzY3JpcHRpb247XHJcbiAgfVxyXG5cclxuICBzZXRVc2VyQXZhdGFyKGF2YXRhckVsZW1lbnQpIHtcclxuICAgIHRoaXMuX2F2YXRhckVsZW1lbnQuc3JjID0gYXZhdGFyRWxlbWVudDtcclxuICAgIHRoaXMuX2F2YXRhckVsZW1lbnQuYWx0ID0gdGhpcy5fbmFtZUVsZW1lbnQudGV4dGNvbnRlbnRcclxuICB9XHJcbn0iXSwibmFtZXMiOlsiQ2FyZCIsImNvbnN0cnVjdG9yIiwiY2FyZERhdGEiLCJjYXJkU2VsZWN0b3IiLCJoYW5kbGVDYXJkQ2xpY2siLCJoYW5kbGVMaWtlQ2xpY2siLCJoYW5kbGVEZWxldGVDbGljayIsInRoaXMiLCJfbmFtZSIsIm5hbWUiLCJfbGluayIsImxpbmsiLCJfY2FyZFNlbGVjdG9yIiwiX2hhbmRsZUNhcmRDbGljayIsImlzTGlrZWQiLCJfb3duZXJJZCIsIm93bmVyIiwiX2lkIiwiX2NhcmRJZCIsIl9oYW5kbGVMaWtlQ2xpY2siLCJfaGFuZGxlRGVsZXRlQ2xpY2siLCJfc2V0RXZlbnRMaXN0ZW5lcnMiLCJfY2FyZEVsZW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwiYWRkRXZlbnRMaXN0ZW5lciIsIl9jYXJkSW1hZ2UiLCJ1cGRhdGVMaWtlcyIsIl90b2dnbGVMaWtlQnV0dG9uIiwiX2xpa2VCdXR0b24iLCJjbGFzc0xpc3QiLCJhZGQiLCJyZW1vdmUiLCJfaGFuZGxlRGVsZXRlIiwiX2dldFRlbXBsYXRlIiwiZG9jdW1lbnQiLCJjb250ZW50IiwiY2xvbmVOb2RlIiwicmVtb3ZlQ2FyZEVsZW1lbnQiLCJnZXRWaWV3IiwiX2NhcmRUaXRsZSIsIl9kZWxldGVCdXR0b24iLCJzcmMiLCJ0ZXh0Q29udGVudCIsImFsdCIsImNvbmZpZyIsImZvcm1FbGVtZW50IiwiX2lucHV0U2VsZWN0b3IiLCJpbnB1dFNlbGVjdG9yIiwiX3N1Ym1pdEJ1dHRvblNlbGVjdG9yIiwic3VibWl0QnV0dG9uU2VsZWN0b3IiLCJfaW5hY3RpdmVCdXR0b25DbGFzcyIsImluYWN0aXZlQnV0dG9uQ2xhc3MiLCJfaW5wdXRFcnJvckNsYXNzIiwiaW5wdXRFcnJvckNsYXNzIiwiX2Vycm9yQ2xhc3MiLCJlcnJvckNsYXNzIiwiX2Zvcm1FbGVtZW50IiwiX3Nob3dJbnB1dEVycm9yIiwiaW5wdXRFbCIsImVycm9yTWVzc2FnZUVsIiwiaWQiLCJ2YWxpZGF0aW9uTWVzc2FnZSIsIl9oaWRlSW5wdXRFcnJvciIsIl9jaGVja0lucHV0VmFsaWRpdHkiLCJ2YWxpZGl0eSIsInZhbGlkIiwidG9nZ2xlQnV0dG9uU3RhdGUiLCJfaGFzSW52YWxpZElucHV0IiwiX3N1Ym1pdEJ1dHRvbiIsImRpc2FibGVkIiwiX2lucHV0RWxzIiwic29tZSIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJmb3JFYWNoIiwiaW5wdXRFbGVtZW50IiwiZW5hYmxlVmFsaWRhdGlvbiIsImUiLCJwcmV2ZW50RGVmYXVsdCIsIlNlY3Rpb24iLCJfcmVmIiwiY29udGFpbmVyIiwiaXRlbXMiLCJyZW5kZXJlciIsIl9yZW5kZXJJdGVtcyIsIl9yZW5kZXJlciIsIl9jb250YWluZXIiLCJyZW5kZXJJdGVtcyIsImNvbnNvbGUiLCJsb2ciLCJpdGVtIiwiYWRkSXRlbSIsImNhcmRFbGVtZW50IiwicHJlcGVuZCIsIlBvcHVwIiwicG9wdXBTZWxlY3RvciIsIl9wb3B1cEVsZW1lbnQiLCJvcGVuIiwiX2hhbmRsZUVzY0Nsb3NlIiwiY2xvc2UiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwiX2Nsb3NlTW9kYWxDbGljayIsInRhcmdldCIsImNvbnRhaW5zIiwia2V5Iiwic2V0RXZlbnRMaXN0ZW5lcnMiLCJQb3B1cFdpdGhGb3JtIiwiaGFuZGxlRm9ybVN1Ym1pdCIsInN1cGVyIiwiX3BvcHVwRm9ybSIsIl9oYW5kbGVGb3JtU3VibWl0IiwiX3N1Ym1pdEJ1dHRvblRleHQiLCJzZXRMb2FkaW5nIiwiaXNMb2FkaW5nIiwibG9hZGluZ1RleHQiLCJhcmd1bWVudHMiLCJsZW5ndGgiLCJ1bmRlZmluZWQiLCJfZ2V0SW5wdXRWYWx1ZXMiLCJ2YWx1ZXMiLCJpbnB1dCIsInZhbHVlIiwiX3N1Ym1pdEZvcm0iLCJldmVudCIsImlucHV0VmFsdWVzIiwic2V0VGltZW91dCIsInJlc2V0IiwicHJvZmlsZVRpdGxlIiwicHJvZmlsZVN1YnRpdGxlIiwicHJvZmlsZUVkaXRCdXR0b24iLCJwcm9maWxlRWRpdE1vZGFsIiwicHJvZmlsZVRpdGxlSW5wdXQiLCJwcm9maWxlU3VidGl0bGVJbnB1dCIsInByb2ZpbGVFZGl0Rm9ybSIsImNhcmRMaXN0RWwiLCJwcm9maWxlQWRkQnV0dG9uIiwiY2FyZEFkZEZvcm0iLCJhdmF0YXJFZGl0QnV0dG9uIiwicHJvZmlsZUF2YXRhciIsImZvcm1TZWxlY3RvciIsImFwaSIsImJhc2VVcmwiLCJoZWFkZXJzIiwiX2Jhc2VVcmwiLCJfaGVhZGVycyIsIl9oYW5kbGVTZXJ2ZXJSZXNwb25zZSIsInJlcyIsImpzb24iLCJ0aGVuIiwiZGF0YSIsIm9rIiwiZXJyb3IiLCJFcnJvciIsInN0YXR1cyIsIm1lc3NhZ2UiLCJfcmVxdWVzdCIsInVybCIsIm9wdGlvbnMiLCJmZXRjaCIsImdldEluaXRpYWxDYXJkcyIsImdldFVzZXJJbmZvIiwiYWRkQ2FyZCIsIl9yZWYyIiwibWV0aG9kIiwiYm9keSIsIkpTT04iLCJzdHJpbmdpZnkiLCJyZW1vdmVDYXJkIiwiY2FyZElkIiwiY2hhbmdlTGlrZVN0YXR1cyIsInVwZGF0ZVVzZXJJbmZvIiwiZGVzY3JpcHRpb24iLCJhYm91dCIsInNldFVzZXJBdmF0YXIiLCJhdmF0YXIiLCJhdXRob3JpemF0aW9uIiwiYWRkRm9ybVZhbGlkYXRvciIsIkZvcm1WYWxpZGF0b3IiLCJlZGl0Rm9ybVZhbGlkYXRvciIsImVkaXRQb3B1cCIsIl9yZWYzIiwidXNlckluZm8iLCJzZXRVc2VySW5mbyIsImNhdGNoIiwiZmluYWxseSIsImF2YXRhckVkaXRQb3B1cCIsIl9yZWY1IiwidXNlckRhdGEiLCJkZWxldGVQb3B1cCIsIl9mb3JtIiwic2V0U3VibWl0QWN0aW9uIiwiYWN0aW9uIiwiaGFuZGxlUHJldmlld0ltYWdlIiwicG9wdXBJbWFnZSIsInJlbmRlckNhcmQiLCJjYXJkU2VjdGlvbiIsInVzZXJJZCIsIlByb21pc2UiLCJhbGwiLCJpbml0aWFsQ2FyZHMiLCJfcHJldmlld0ltYWdlRWxlbWVudCIsIl9wcmV2aWV3SW1hZ2VDYXB0aW9uIiwidXNlck5hbWVFbGVtZW50IiwidXNlckpvYkVsZW1lbnQiLCJhdmF0YXJFbGVtZW50IiwiX25hbWVFbGVtZW50IiwiX2pvYkVsZW1lbnQiLCJfYXZhdGFyRWxlbWVudCIsInByb2ZpbGVPYmplY3QiLCJ0ZXh0Y29udGVudCIsIm5ld0NhcmRQb3B1cCIsIl9yZWY0IiwibG9jYXRpb24iLCJyZWxvYWQiXSwic291cmNlUm9vdCI6IiJ9